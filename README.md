# AI Wiki

AIを使用したWiki生成プロジェクトです。

## 概要

このプロジェクトは、Cursorエージェント用コマンドを使用して、指定ディレクトリを分析し、Wiki構造を決定するためのトピック分析とWikiコンテンツ生成の機能を提供します。プロジェクトのファイルツリーとREADMEを基に、包括的なWiki構造を自動生成し、Markdown形式のWikiページを作成します。

## 主な機能

### `/ai-wiki/init` - Wiki構造生成

指定ディレクトリを分析して、Wiki構造をJSON形式で生成します。

- **ディレクトリ分析**: `repo/<指定ディレクトリ>`形式で指定されたディレクトリのファイルツリーを分析
- **README読み取り**: プロジェクトのREADMEファイルの内容を読み取り
- **既存構造の読み込み**: 既存の`wiki_structure.json`が存在する場合、前回のセクション情報を読み込み
- **セクション情報の維持**: 既存のセクション構成（セクションID、タイトル、階層構造）を維持しながらWiki構造を更新
- **構成類似度評価**: 既存の構成と新規分析結果を比較し、適切に構成維持の判断を実行
- **Wiki構造生成**: プロジェクトの構造と内容に基づいて、論理的なWiki構造（セクションとページ）を自動生成
- **JSON出力**: 生成されたWiki構造を`[出力先ディレクトリ]/wiki_structure.json`に保存

生成されるWiki構造の特徴:
- **セクション構造**: プロジェクトの主要な側面をカバーするセクション（概要、アーキテクチャ、コア機能、バックエンド、デプロイメント、拡張性など）
- **ページ定義**: 各セクションに属するページで、タイトル、説明、重要度、関連ファイル、関連ページへの参照を含む
- **視覚化に適したページ**: アーキテクチャ概要、データフロー、コンポーネント関係図など、図解が有効なページを自動的に含める

### `/ai-wiki/make` - Wikiページ生成

`wiki_structure.json`を読み込んで、定義された全ページのWikiコンテンツをMarkdown形式で生成します。

- **JSON読み込み**: `.wiki/wiki_structure.json`ファイルの読み込みと検証
- **ページ生成**: 定義された全ページのWikiコンテンツを自動生成
- **出力先指定**: 出力先ディレクトリを引数で指定可能（デフォルトは`wiki/`）
- **セクション構造維持**: セクション構造を維持したWikiページを生成
- **リンク生成**: ページ間のリンクを適切に自動生成
- **サイドバー生成**: サイドバーファイル（`_sidebar.md`）を自動生成（GitBookやDocsifyなどの一般的なWikiシステムで利用可能）

生成されるWikiページの特徴:
- **Mermaidダイアグラム**: アーキテクチャ図、データフロー図、コンポーネント関係図などを自動生成
- **コードスニペット**: 関連ファイルからのコード引用を含む
- **テーブル**: 構造化された情報をテーブル形式で表示
- **相互リンク**: 関連ページへの適切なリンクを自動生成

## 使用方法

### 基本的なワークフロー

1. **AI Wikiをクローン**
   ```sh
   /> git clone https://github.com/paterapatera/ai-wiki.git
   ```
2. **Wikiを作りたいリポジトリをクローン**
   ```sh
   /> cd ai-wiki
   /ai-wiki> mkdir repo
   /ai-wiki> cd repo
   /ai-wiki/repo> git clone 対象のリポジトリ
   ```

3. **AIエージェントのプロンプトでWiki構造の生成**

   ```
   /ai-wiki/init repo/<対象のディレクトリ> [出力先ディレクトリ]
   ```
   
   引数の説明:
   - `repo/<対象のディレクトリ>`: 分析対象のディレクトリ（必須）
   - `[出力先ディレクトリ]`: Wiki構造JSONファイルの出力先（オプション、デフォルトは`.wiki`）
   
   これにより、`[出力先ディレクトリ]/wiki_structure.json`が生成されます。
   
   **既存構造の維持**:
   - 既存の`wiki_structure.json`が存在する場合、前回のセクション情報を読み込み、構成を維持しながらWiki構造を更新します
   - `project_root`が一致し、セクション構造が類似している場合、既存のセクション構成を維持します
   - 内容が大きく乖離する場合、新規構成を採用します

4. **AIエージェントのプロンプトでWikiページの生成**
   ```
   /ai-wiki/make [出力先ディレクトリ]
   ```
   これにより、`.wiki/wiki_structure.json`を基に全Wikiページが生成されます。
   `repo/<対象のリポジトリ>.wiki.git`をクローンして指定するのがおすすめです。
   出力先ディレクトリを指定しない場合、デフォルトで`wiki/`ディレクトリに出力されます。
   
   **注意**: `/ai-wiki/init`コマンドの完了通知に、次に実行すべき`/ai-wiki/make`コマンドの案内が表示されます。

### 出力ファイル

- `[出力先ディレクトリ]/wiki_structure.json`: Wiki構造定義ファイル（JSON形式、デフォルトは`.wiki/wiki_structure.json`）
- `wiki/`（または指定した出力先）: 生成されたWikiページ（Markdown形式）
- `wiki/_sidebar.md`: サイドバーファイル（自動生成）

### 再実行時の動作

`/ai-wiki/init`コマンドを再実行する場合：

- **既存の`wiki_structure.json`が存在する場合**:
  - 既存のセクション情報（セクションID、タイトル、階層構造）を読み込み
  - 既存のページIDとセクションIDのマッピング情報を保持
  - 構成類似度を評価し、適切に構成維持の判断を実行
  - 既存のセクション構成を維持しながら、新しいページを適切に配置
  - 既存のページIDと一致するページには、既存の`parent_section`と`related_pages`を維持

- **既存の`wiki_structure.json`が存在しない場合**:
  - 新規作成モードとして処理を続行
  - 完全に新しいWiki構造を生成

## 環境要件

### 必要な環境

- **Docker**: JSONファイルの検証に使用します（必須）
- **Python/Node.js**: ホスト環境にはインストール不要です（Dockerコンテナ内で使用されます）

### 動作確認済み環境

- Dockerがインストールされ、実行可能な状態であること
- Cursor IDEのエージェント機能が利用可能であること

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。詳細は[LICENSE](./LICENSE)ファイルを参照してください。

### 使用しているオープンソース

このプロジェクトは、[deepwiki-open](https://github.com/AsyncFuncAI/deepwiki-open)の一部ソースコードを使用しています。
